extends layout

block scripts
    script(src="/public/scripts.js")
    script.
        $(document).ready(function (){
            colorRows()
            const screensize = $( window ).width()
            if(screensize <= '640'){
                mobileFriendlyLists()
            }
        })

block content    
    if activeTournaments.length > 1
        div.columns.pb-2
            div(class='column col-3 col-sm-12')
                span.text-gray Aktiiviset turnaukset:
            div(class='column col-9 col-sm-12')
                for tournament in activeTournaments
                    span.chip
                        a(href="/home/"+tournament.id)= tournament.name
    div.columns
        div(class='column col-12')
            img(src='/public/img/banner.png' class='img-responsive banner')
    div.columns
        div(class='column col-12')
            span.text-gray Turnaus
            a(href="/tournament/" + tournament.id)
                h1#index-tournament-name= tournament.name
        div(class='column col-6')
            span.text-gray Alkaa
            p.text-primary #{moment(tournament.datestarts).format("D.MM.YYYY")}
        div(class='column col-6')
            span.text-gray Loppuu
            p.text-primary #{moment(tournament.dateends).format("D.MM.YYYY")}
    div.columns
        div(class='column col-md-6 col-sm-12 card')
            h4.card-heading 
                i(class="fa fa-calendar-check-o card-icon" aria-hidden="true")
                | Päivän pelit
            if tournament.todaysGames.length > 0
                table(class='table table-hover')
                    thead
                        tr
                            th Klo
                            th Peli
                            th Tulos
                    tbody
                        for game in tournament.todaysGames
                            tr
                                td= moment(game.game_start_datetime).format("H:mm")
                                td
                                    +gamesVersusElement(game)
                                if game.team_1_score 
                                    td #{game.team_1_score} - #{game.team_2_score}
                                else
                                    td TBA
            else                
                div.empty
                    div.empty-icon
                        i(class="fa fa-calendar-times-o fa-5x" aria-hidden="true")
                    p.empty-title.h5 Ei pelejä tänään
        div(class='column col-md-6 col-sm-12 card')
            h4.card-heading 
                i(class="fa fa-calendar-o card-icon" aria-hidden="true")
                | Huomisen pelit
            if tournament.tomorrowsGames.length > 0
                table(class='table table-hover')
                    thead
                        tr
                            th Klo
                            th Peli
                    tbody
                    for game in tournament.tomorrowsGames
                        tr
                            td= moment(game.game_start_datetime).format("H:mm")
                            td
                                +gamesVersusElement(game)
            else                
                div.empty
                    div.empty-icon
                        i(class="fa fa-calendar-times-o fa-5x" aria-hidden="true")
                    p.empty-title.h5 Ei pelejä huomiselle
    if tournament.topstriker
        div.columns
            div(class='column col-12 card')
                h4.card-heading 
                    i(class="fa fa-futbol-o card-icon" aria-hidden="true")
                    | Maalitykit
    div.columns
        div(class='column col-md-6 col-sm-12 card')
            h4.card-heading 
                i(class="fa fa-list-ul card-icon" aria-hidden="true")
                | Omat veikkaukset
            if currentUser.pools && currentUser.pools.length > 0
                +poolsTable(currentUser.pools, currentUser.extraPools)
            else if moment(tournament.dateplayingstarts) < moment() && moment(tournament.datestarts) > moment()
                div.empty
                    div.empty-icon
                        i(class="fa fa-users fa-5x" aria-hidden="true")
                    p.empty-title.h5 Hei, #{user.username}!
                    p.empty-subtitle Paina nappia osallistuaksesi peliin!
                    div.empty-action
                        a(href="/participate/tournament/" + tournament.id)
                            button.btn.btn-primary Osallistu
            else 
                div.empty
                    div.empty-icon
                        i(class="fa fa-calendar-times-o fa-5x" aria-hidden="true")
                    p.empty-title.h5 Pahoittelut, #{user.username}!
                    p.empty-subtitle Peliin osallistuminen ei ole enää mahdollista.


        div(class='column col-md-6 col-sm-12 card')
            h4.card-heading 
                i(class="fa fa-trophy card-icon" aria-hidden="true")
                | Leaderboard
    
            table(class='table table-striped table-hover')
                thead
                    tr
                        th Nimi
                        th Pisteet
                tbody
                if tournament.scores && user
                    for score in tournament.scores
                        if user.id == score.id
                            tr.bg-primary-imporant
                                td= score.username
                                td= score.score
                        else
                            tr
                                td= score.username
                                td= score.score
        div(class='column col-12 card')
            h4.card-heading 
                i(class="fa fa-bar-chart card-icon" aria-hidden="true")
                | Kaikkien veikkaukset
                table.table.table-striped
                    thead
                        tr
                            th Peli
                            th 1
                            th X
                            th 2
                    tbody
                    for game in tournament.pools
                        tr
                            td
                                +gamesVersusElement(game) 
                            td                                
                                if game.pool_1
                                    span.chip.bg-primary(onclick="toggleModal(this)")= game.pool_1_percentage.toFixed() +" %"
                                    div.modal.modal-sm
                                        a(class="modal-overlay" onclick="toggleModal(this)")                                            
                                        div.modal-container
                                            div.modal-header
                                                a(class="btn btn-clear float-right" onclick="toggleModal(this)")
                                                div.modal-title.h5 Veikanneet
                                            div.modal-body
                                                div.content
                                                    ul
                                                    for u in game.pool_1
                                                        li= u
                                            div.modal-footer
                            td
                                if game.pool_x
                                    span.chip.bg-primary(onclick="toggleModal(this)")= game.pool_x_percentage.toFixed() +" %"
                                    div.modal.modal-sm
                                        a(class="modal-overlay" onclick="toggleModal(this)")                                            
                                        div.modal-container
                                            div.modal-header
                                                a(class="btn btn-clear float-right" onclick="toggleModal(this)")
                                                div.modal-title.h5 Veikanneet
                                            div.modal-body
                                                div.content
                                                    ul
                                                    for u in game.pool_x
                                                        li= u
                                            div.modal-footer
                            td                   
                                if game.pool_2
                                    span.chip.bg-primary(onclick="toggleModal(this)")= game.pool_2_percentage.toFixed() +" %"       
                                    div.modal.modal-sm
                                        a(class="modal-overlay" onclick="toggleModal(this)")                                            
                                        div.modal-container
                                            div.modal-header
                                                a(class="btn btn-clear float-right" onclick="toggleModal(this)")
                                                div.modal-title.h5 Veikanneet
                                            div.modal-body
                                                div.content
                                                    ul
                                                    for u in game.pool_2
                                                        li= u
                                            div.modal-footer
        
